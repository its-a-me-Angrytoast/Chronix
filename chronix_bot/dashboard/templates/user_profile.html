{% extends "base.html" %}
{% block content %}
  <h1>User Profile: {{ user_id }}</h1>
  <form id="profile-form">
    <label>Display name</label>
    <input name="display_name" value="{{ profile.get('display_name','') }}" />
    <label>Bio</label>
    <textarea name="bio">{{ profile.get('bio','') }}</textarea>
    <button class="btn primary" type="submit">Save</button>
  </form>
  <script>
    document.getElementById('profile-form').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const form = e.currentTarget;
      const data = {display_name: form.display_name.value, bio: form.bio.value};
      const res = await fetch('/users/' + encodeURIComponent('{{ user_id }}'), {method:'PUT', headers:{'content-type':'application/json'}, body: JSON.stringify(data)});
      if(res.ok) alert('Saved'); else alert('Error');
    });
  </script>
{% endblock %}
